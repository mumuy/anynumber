/*!
 * anynumber v1.0.0
 * big number parser tool.
 * https://passer-by.com/anynumber/
 *
 * Copyright (c) 2024-present, HaoLe Zheng
 *
 * Released under the MIT License
 * https://github.com/mumuy/anynumber
 *
 * Created on: 2024-03-31
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).AnyNumber=e()}(this,(function(){"use strict";function t(t){var e=t.toString().replace(/^-/,""),n=0==t.toString().indexOf("-"),i=e.length,r=e.indexOf("."),u=r>-1?i-r-1:0;return e=e.replace(".",""),{value:BigInt((n?"-":"")+e),time:BigInt("1"+new Array(u).fill("0").join(""))}}function e(i,r,u){var o=function(e,n){var i=t(e),r=t(n),u=i.time*r.time;return{value1:i.value*r.time,value2:r.value*i.time,time1:r.time,time2:i.time,time:u}}(i,u),l=null,a=1,d=o.time.toString().length-1;if("+"==r)l=t(o.value1+o.value2),a=o.time;else if("-"==r)l=t(o.value1-o.value2),a=o.time;else if("*"==r)l=t(o.value1*o.value2),a=o.time*o.time;else if("/"==r){var f=BigInt("1"+new Array(36+d).fill("0").join(""));l=t(o.value1*f/o.value2),a=f}else{if("**"!=r){if("%"==r){var h=Math.floor(Math.abs(i)/Math.abs(u)),v=0==Math.floor(i/u).toString().indexOf("-"),c=e(Math.abs(h),"*",Math.abs(u));return(v?"-":"")+e(Math.abs(i),"-",c)}return NaN}a=(l=t(Math.pow(i,u))).time}var s=l.value.toString().replace(/^-/,""),g=0==l.value.toString().indexOf("-"),p=new Array(36+d).fill("0").concat(s.split("")),m=p.length-(a.toString().length-1);return p.splice(m,0,"."),(g?"-":"")+n(p.join(""),32).replace(/^0+/,"").replace(/(?<=\.\d*)0*$/,"").replace(/\.0*$/,"").replace(/^\./,"0.")}function n(t,n){n=Math.max(0,n);var i=new Array(n).fill("0").join(""),r=(t+=t.includes(".")?i:"."+i).indexOf(".")+n,u=+t.charAt(r+1);(t=t.substring(0,r+1),u>=5)&&(t=e(t,"+","0."+i.substring(1)+"1"));return t}function i(t){var n=[{exp:/\s/g,fun:function(){return""}},{exp:/([\+\-]?\d*\.\d*|[\+\-]?\d*)e([\+\-]?\d*\.\d*|[\+\-]?\d*)/g,fun:function(){return n=(t=arguments.length<=0?void 0:arguments[0]).toString().match(/([\+\-]?\d*\.\d*|[\+\-]?\d*)e([\+\-]?\d*\.\d*|[\+\-]?\d*)/),i=BigInt(1),r=BigInt(1),n?(i=n[1],+n[2]>0?r="1"+new Array(+n[2]).fill("0").join(""):+n[2]<0&&(r=e("1","/",BigInt("1"+new Array(Math.abs(n[2])).fill("0").join("")))),e(i,"*",r)):t.toString();var t,n,i,r}},{exp:/\+\(([\+\-]\d*\.\d*|[\+\-]\d)\)/g,fun:function(){return arguments.length<=1?void 0:arguments[1]}},{exp:/\-\(\-(\d*\.\d*|\d)\)/g,fun:function(){return"+"+(arguments.length<=1?void 0:arguments[1])}},{exp:/\-\(\+(\d*\.\d*|\d)\)/g,fun:function(){return"-"+(arguments.length<=1?void 0:arguments[1])}},{exp:/\((.+)\)/g,fun:function(){return i(arguments.length<=1?void 0:arguments[1])}},{exp:/(^\-\d*\.\d*|^\-\d+|\d*\.\d*|\d+)(\*\*|\*|\/|%)(\([\+\-]?\d*\.\d*|[\+\-]?\d+\))/g,fun:function(){return e(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3])}},{exp:/(^\-\d*\.\d*|^\-\d+|\d*\.\d*|\d+)(\*\*|\*|\/|%)([\+\-]?\d*\.\d*|[\+\-]?\d+)/g,fun:function(){return e(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3])}},{exp:/(^\-\d*\.\d*|^\-\d+|\d*\.\d*|\d+)([\+\-])([\+\-]?\d*\.\d*|[\+\-]?\d+)/,fun:function(){return e(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3])}}],r=function t(e){var i=e;return n.forEach((function(t){i=i.replace(t.exp,t.fun)})),i!=e?t(i):i}(t);return r}var r={value:null,init:function(t){this.value=i(t.toString())},add:function(t){return this.value=e(this.value,"+",t),this},subtract:function(t){return this.value=e(this.value,"-",t),this},multiply:function(t){return this.value=e(this.value,"*",t),this},divide:function(t,i){return this.value=e(this.value,"/",t),i?n(this.value,i):this},mod:function(t){return this.value=e(this.value,"%",t),this},sqrt:function(){return this.value=Math.sqrt(this.toNumber()).toString(),this},pow:function(t){return this.value=Math.pow(this.toNumber(),t).toString(),this},toFormat:function(t){return function(t,e){var n=new RegExp("([\\d,]+\\.?(\\d{0,"+e+"})?).*"),i=t.replace(/[^\d\.]/g,"").replace(/^[^\d]/,"").replace(n,"$1"),r=(+i).toFixed(e),u="";return i&&((t=r.split(".")[0])&&(t=t.replace(/\d(?=(?:\d{3})+\b)/g,"$&,")),u=i.replace(/(\d)*(\.\d*)?/,t+"$2")),u}(this.value,t)},toExponential:function(t){return this.toNumber().toExponential(t)},toFixed:function(t){return n(this.value,t)},toString:function(){return this.value},toNumber:function(){return+this.value}},u=function t(e){return new t.prototype.init(e)};return u.prototype=r,r.init.prototype=r,console.log("[factory]",u),u}));
