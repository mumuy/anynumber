/*!
 * anynumber v1.0.2
 * big number parser tool.
 * https://passer-by.com/anynumber/
 *
 * Copyright (c) 2024-present, HaoLe Zheng
 *
 * Released under the MIT License
 * https://github.com/mumuy/anynumber
 *
 * Created on: 2024-11-11
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).AnyNumber=e()}(this,(function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function e(e,n){return function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,u,o,l=[],a=!0,d=!1;try{if(u=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=u.call(n)).done)&&(l.push(r.value),l.length!==e);a=!0);}catch(t){d=!0,i=t}finally{try{if(!a&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(d)throw i}}return l}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t){var e=u(t).replace(/^-/,""),n=0==u(t).indexOf("-"),r=e.length,i=e.indexOf("."),o=i>-1?r-i-1:0;return e=e.replace(".",""),{value:BigInt((n?"-":"")+e),time:BigInt("1"+new Array(o).fill("0").join(""))}}function r(t,e,u){var o=null,l=1,a=1;if("**"==e)a=(o=n(Math.pow(t,u))).time.toString().length-1,l=o.time;else{if("%"==e){var d=Math.floor(Math.abs(t)/Math.abs(u)),f=0==Math.floor(t/u).toString().indexOf("-"),c=r(Math.abs(d),"*",Math.abs(u));return(f?"-":"")+r(Math.abs(t),"-",c)}var h=function(t,e){var r=n(t),i=n(e),u=r.time*i.time;return{value1:r.value*i.time,value2:i.value*r.time,time1:i.time,time2:r.time,time:u}}(t,u);if(a=h.time.toString().length-1,"+"==e)o=n(h.value1+h.value2),l=h.time;else if("-"==e)o=n(h.value1-h.value2),l=h.time;else if("*"==e)o=n(h.value1*h.value2),l=h.time*h.time;else if("/"==e){var s=BigInt("1"+new Array(36+a).fill("0").join(""));o=n(h.value1*s/h.value2),l=s}}var v=o.value.toString().replace(/^-/,""),g=0==o.value.toString().indexOf("-"),p=new Array(36+a).fill("0").concat(v.split("")),m=p.length-(l.toString().length-1);return p.splice(m,0,"."),(g?"-":"")+(i(p.join(""),32).replace(/^0+/,"").replace(/(?<=\.\d*)0*$/,"").replace(/\.0*$/,"").replace(/^\./,"0.")||"0")}function i(t,e){e=Math.max(0,e);var n=new Array(e).fill("0").join(""),i=(t+=t.includes(".")?n:"."+n).indexOf(".")+e,u=+t.charAt(i+1);(t=t.substring(0,i+1),u>=5)&&(t=r(t,"+","0."+n.substring(1)+"1"));return t}function u(t){var e=t.toString().match(/([\+\-]?\d*\.\d*|[\+\-]?\d*)e([\+\-]?\d*\.\d*|[\+\-]?\d*)/),n=BigInt(1),i=BigInt(1);return e?(n=e[1],+e[2]>0?i="1"+new Array(+e[2]).fill("0").join(""):+e[2]<0&&(i=r("1","/",BigInt("1"+new Array(Math.abs(e[2])).fill("0").join("")))),r(n,"*",i)):t.toString()}function o(t){var e=[{exp:/\s/g,fun:function(){return""}},{exp:/([\+\-]?\d*\.\d*|[\+\-]?\d*)e([\+\-]?\d*\.\d*|[\+\-]?\d*)/g,fun:function(){return u(arguments.length<=0?void 0:arguments[0])}},{exp:/\+\(([\+\-]\d*\.\d*|[\+\-]\d)\)/g,fun:function(){return arguments.length<=1?void 0:arguments[1]}},{exp:/\-\(\-(\d*\.\d*|\d)\)/g,fun:function(){return"+"+(arguments.length<=1?void 0:arguments[1])}},{exp:/\-\(\+(\d*\.\d*|\d)\)/g,fun:function(){return"-"+(arguments.length<=1?void 0:arguments[1])}},{exp:/\((.+)\)/g,fun:function(){return o(arguments.length<=1?void 0:arguments[1])}},{exp:/(^\-\d*\.\d*|^\-\d+|\d*\.\d*|\d+)(\*\*|\*|\/|%)(\([\+\-]?\d*\.\d*|[\+\-]?\d+\))/g,fun:function(){return r(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3])}},{exp:/(^\-\d*\.\d*|^\-\d+|\d*\.\d*|\d+)(\*\*|\*|\/|%)([\+\-]?\d*\.\d*|[\+\-]?\d+)/g,fun:function(){return r(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3])}},{exp:/(^\-\d*\.\d*|^\-\d+|\d*\.\d*|\d+)([\+\-])([\+\-]?\d*\.\d*|[\+\-]?\d+)/,fun:function(){return r(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3])}}],n=function(t){var r=t;return e.forEach((function(t){r=r.replace(t.exp,t.fun)})),r!=t?n(r):r};return n(t)}var l={value:null,init:function(t){this.value=o(t.toString())},add:function(t){return this.value=r(this.value,"+",t),this},subtract:function(t){return this.value=r(this.value,"-",t),this},multiply:function(t){return this.value=r(this.value,"*",t),this},divide:function(t,e){return this.value=r(this.value,"/",t),e?i(this.value,e):this},mod:function(t){return this.value=r(this.value,"%",t),this},sqrt:function(){return this.value=Math.sqrt(this.toNumber()).toString(),this},pow:function(t){return this.value=Math.pow(this.toNumber(),t).toString(),this},toFormat:function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return function(t){var n=new RegExp("([\\d,]+\\.?(\\d{0,"+e+"})?).*"),r=t.replace(/[^\d\.]/g,"").replace(/^[^\d]/,"").replace(n,"$1").replace(/\.$/,""),i=(+r).toFixed(e),u="";return r&&((t=i.split(".")[0])&&(t=t.replace(/\d(?=(?:\d{3})+\b)/g,"$&,")),u=r.replace(/(\d)*(\.\d*)?/,t+"$2")),u}(t)}(this.value,t)},toExponential:function(t){return this.toNumber().toExponential(t)},toFixed:function(t){return i(this.value,t)},toChineseExpression:function(){return function(t){var n=(+(+t).toFixed(2)).toString(),r=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖","拾"],i=["","拾","佰","仟","万"],u=["","万","亿","兆","京"],o=["圆","角","分"],l=e(n.split("."),2),a=l[0],d=l[1];if(a.length>16)return"数值超过范围";var f=a.replace(/\d(?=(?:\d{4})+\b)/g,"$&,").split(",").reverse().map((function(t,e){var n=t.split("").map((function(e,n){var u=t.length-n-1;return"0"==e?r[e]:r[e]+i[u%4]})).join("").replace(/零+/g,"零").replace(/零$/g,"");return n&&(n+=u[e]),n})).reverse().join("").replace(/零+/g,"零").replace(/零$/g,"");f||(f="零"),f+=o[0];var c="";return d&&d.length?d.split("").forEach((function(t,e){f+=r[t]+o[e+1]})):c+="整",f+c}(this.value)},toString:function(){return this.value},toNumber:function(){return+this.value}},a=function(t){return new a.prototype.init(t)};return a.prototype=l,l.init.prototype=l,a}));
